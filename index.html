<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Imagens</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="imagen/Gemini_Generated_Image_mx02zmmx02zmmx02.png" type="image/png">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="imagen/Gemini_Generated_Image_mx02zmmx02zmmx02.png" alt="Logo" class="logo-img">
            </div>
            <div class="menu-profile">
                <ul class="menu">
                    <li><a href="home.html">Home</a></li>
                    <li><a href="planos.html">Planos</a></li>
                    <li><a href="index.html">Estudar</a></li>
                </ul>

                <div class="profile dropdown">
                    <img 
                        id="user-profile-pic" 
                        src="imagen/default-profile.png" 
                        alt="Foto de Perfil" 
                        class="profile-pic"
                        onerror="this.src='imagen/is-there-any-possible-way-to-mak.png';"
                    >
                    <div class="dropdown-content">
                        <a href="perfil.html" id="profile-link">Perfil</a>
                        <a href="#" id="logout-link">Sair</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="main-content-wrapper"> 
            <div class="input-section">
                <h2>Digite o texto da sua imagem:</h2>
                <textarea id="textInput" placeholder="Ex: Um gato astronauta flutuando no espaço com planetas coloridos ao fundo."></textarea>
                <button id="generateBtn">Gerar Imagem</button>
            </div>
            
            <div id="imageContainer">
                
                <p>Sua imagem gerada aparecerá aqui</p>
            </div>

            <div class="mission-section">
                <h1>REFERÊNCIAS VISUAIS</h1>
                
                <p>Gere uma imagem baseado nessas duas imagens:</p> 
                
                <div class="mission-images">
                    <img id="refImage1" src="imagen\Geração2.jpg" alt="Imagem de Referência 1">
                    
                    <img id="refImage2" src="imagen\Geração1.jpg" alt="Imagem de Referência 2">
                </div>
                
                </div>
        </div>
    </main>

    <footer>
        <p>© 2025 Gerador de Imagens. Todos os direitos reservados.</p>
    </footer>

    <script>
        'use strict';

        // Verifica se existe token
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = 'loggin.html';
        }

        // Logout
        document.getElementById("logout-link").addEventListener("click", () => {
            localStorage.removeItem("token");
            window.location.href = "loggin.html";
        });

        // FOTO DE PERFIL DO USUÁRIO (Google)
        const userData = JSON.parse(localStorage.getItem('userData')); 
        const userProfilePic = document.getElementById('user-profile-pic');

        if (userData && userData.picture) {
            userProfilePic.src = userData.picture; // foto do Google
        } else {
            userProfilePic.src = "imagen/default-profile.png"; // padrão local
        }

        // Gerar imagem (exemplo com Pexels API)
        const API_KEY = 'uC2espeKwTtgQTUNuMwOcQgzL9u6kmQoNiVVab6CXxHV1CzMK0J6X4Qq';

        document.getElementById('generateBtn').addEventListener('click', async function() {
            const inputText = document.getElementById('textInput').value.trim();
            if (!inputText) return alert('Digite algo no campo de texto.');

            try {
                const response = await fetch(`https://api.pexels.com/v1/search?query=${encodeURIComponent(inputText)}&per_page=1`, {
                    headers: { Authorization: API_KEY }
                });
                const data = await response.json();
                const imageContainer = document.getElementById('imageContainer');
                imageContainer.innerHTML = '';

                if (data.photos && data.photos.length > 0) {
                    const img = document.createElement('img');
                    img.src = data.photos[0].src.large; 
                    img.alt = 'Imagem gerada';
                    imageContainer.appendChild(img);
                } else {
                    imageContainer.innerHTML = '<p>Nenhuma imagem encontrada.</p>';
                }
            } catch (err) {
                console.error(err);
                alert('Erro ao gerar imagem.');
            }
        });
    </script>
</body>
</html>